{"ast":null,"code":"import React,{createContext,useContext,useState,useRef,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PlayerContext=/*#__PURE__*/createContext();export const usePlayer=()=>{const context=useContext(PlayerContext);if(!context){throw new Error('usePlayer must be used within a PlayerProvider');}return context;};export const PlayerProvider=_ref=>{let{children}=_ref;const[currentTrack,setCurrentTrack]=useState(null);const[isPlaying,setIsPlaying]=useState(false);const[currentTime,setCurrentTime]=useState(0);const[duration,setDuration]=useState(0);const[volume,setVolume]=useState(0.7);const[queue,setQueue]=useState([]);const[currentIndex,setCurrentIndex]=useState(0);const audioRef=useRef(null);// Load user preferences from localStorage\nuseEffect(()=>{const savedVolume=localStorage.getItem('player_volume');if(savedVolume){setVolume(parseFloat(savedVolume));}},[]);// Save volume to localStorage when it changes\nuseEffect(()=>{localStorage.setItem('player_volume',volume.toString());if(audioRef.current){audioRef.current.volume=volume;}},[volume]);// Audio event handlers\nuseEffect(()=>{const audio=audioRef.current;if(!audio)return;const handleTimeUpdate=()=>{setCurrentTime(audio.currentTime);};const handleDurationChange=()=>{setDuration(audio.duration);};const handleEnded=()=>{playNext();};const handleLoadStart=()=>{setCurrentTime(0);setDuration(0);};const handleCanPlay=()=>{if(isPlaying){audio.play().catch(console.error);}};audio.addEventListener('timeupdate',handleTimeUpdate);audio.addEventListener('durationchange',handleDurationChange);audio.addEventListener('ended',handleEnded);audio.addEventListener('loadstart',handleLoadStart);audio.addEventListener('canplay',handleCanPlay);return()=>{audio.removeEventListener('timeupdate',handleTimeUpdate);audio.removeEventListener('durationchange',handleDurationChange);audio.removeEventListener('ended',handleEnded);audio.removeEventListener('loadstart',handleLoadStart);audio.removeEventListener('canplay',handleCanPlay);};},[isPlaying]);const playTrack=track=>{if(!track||!track.preview){console.warn('Track has no preview URL');return;}setCurrentTrack(track);setIsPlaying(true);if(audioRef.current){audioRef.current.src=track.preview;audioRef.current.load();}};const togglePlayPause=()=>{if(!audioRef.current||!currentTrack)return;if(isPlaying){audioRef.current.pause();setIsPlaying(false);}else{audioRef.current.play().catch(console.error);setIsPlaying(true);}};const seekTo=time=>{if(audioRef.current){audioRef.current.currentTime=time;setCurrentTime(time);}};const playNext=()=>{if(queue.length>0&&currentIndex<queue.length-1){const nextIndex=currentIndex+1;setCurrentIndex(nextIndex);playTrack(queue[nextIndex]);}else{setIsPlaying(false);}};const playPrevious=()=>{if(queue.length>0&&currentIndex>0){const prevIndex=currentIndex-1;setCurrentIndex(prevIndex);playTrack(queue[prevIndex]);}};const addToQueue=tracks=>{setQueue(prevQueue=>[...prevQueue,...tracks]);};const clearQueue=()=>{setQueue([]);setCurrentIndex(0);};const playQueue=function(tracks){let startIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;setQueue(tracks);setCurrentIndex(startIndex);if(tracks[startIndex]){playTrack(tracks[startIndex]);}};const formatTime=time=>{if(isNaN(time))return'0:00';const minutes=Math.floor(time/60);const seconds=Math.floor(time%60);return\"\".concat(minutes,\":\").concat(seconds.toString().padStart(2,'0'));};const value={currentTrack,isPlaying,currentTime,duration,volume,queue,currentIndex,playTrack,togglePlayPause,seekTo,playNext,playPrevious,setVolume,addToQueue,clearQueue,playQueue,formatTime};return/*#__PURE__*/_jsxs(PlayerContext.Provider,{value:value,children:[children,/*#__PURE__*/_jsx(\"audio\",{ref:audioRef})]});};","map":{"version":3,"names":["React","createContext","useContext","useState","useRef","useEffect","jsx","_jsx","jsxs","_jsxs","PlayerContext","usePlayer","context","Error","PlayerProvider","_ref","children","currentTrack","setCurrentTrack","isPlaying","setIsPlaying","currentTime","setCurrentTime","duration","setDuration","volume","setVolume","queue","setQueue","currentIndex","setCurrentIndex","audioRef","savedVolume","localStorage","getItem","parseFloat","setItem","toString","current","audio","handleTimeUpdate","handleDurationChange","handleEnded","playNext","handleLoadStart","handleCanPlay","play","catch","console","error","addEventListener","removeEventListener","playTrack","track","preview","warn","src","load","togglePlayPause","pause","seekTo","time","length","nextIndex","playPrevious","prevIndex","addToQueue","tracks","prevQueue","clearQueue","playQueue","startIndex","arguments","undefined","formatTime","isNaN","minutes","Math","floor","seconds","concat","padStart","value","Provider","ref"],"sources":["/workspace/frontend/src/context/PlayerContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useRef, useEffect } from 'react';\n\nconst PlayerContext = createContext();\n\nexport const usePlayer = () => {\n  const context = useContext(PlayerContext);\n  if (!context) {\n    throw new Error('usePlayer must be used within a PlayerProvider');\n  }\n  return context;\n};\n\nexport const PlayerProvider = ({ children }) => {\n  const [currentTrack, setCurrentTrack] = useState(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [volume, setVolume] = useState(0.7);\n  const [queue, setQueue] = useState([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  \n  const audioRef = useRef(null);\n\n  // Load user preferences from localStorage\n  useEffect(() => {\n    const savedVolume = localStorage.getItem('player_volume');\n    if (savedVolume) {\n      setVolume(parseFloat(savedVolume));\n    }\n  }, []);\n\n  // Save volume to localStorage when it changes\n  useEffect(() => {\n    localStorage.setItem('player_volume', volume.toString());\n    if (audioRef.current) {\n      audioRef.current.volume = volume;\n    }\n  }, [volume]);\n\n  // Audio event handlers\n  useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n\n    const handleTimeUpdate = () => {\n      setCurrentTime(audio.currentTime);\n    };\n\n    const handleDurationChange = () => {\n      setDuration(audio.duration);\n    };\n\n    const handleEnded = () => {\n      playNext();\n    };\n\n    const handleLoadStart = () => {\n      setCurrentTime(0);\n      setDuration(0);\n    };\n\n    const handleCanPlay = () => {\n      if (isPlaying) {\n        audio.play().catch(console.error);\n      }\n    };\n\n    audio.addEventListener('timeupdate', handleTimeUpdate);\n    audio.addEventListener('durationchange', handleDurationChange);\n    audio.addEventListener('ended', handleEnded);\n    audio.addEventListener('loadstart', handleLoadStart);\n    audio.addEventListener('canplay', handleCanPlay);\n\n    return () => {\n      audio.removeEventListener('timeupdate', handleTimeUpdate);\n      audio.removeEventListener('durationchange', handleDurationChange);\n      audio.removeEventListener('ended', handleEnded);\n      audio.removeEventListener('loadstart', handleLoadStart);\n      audio.removeEventListener('canplay', handleCanPlay);\n    };\n  }, [isPlaying]);\n\n  const playTrack = (track) => {\n    if (!track || !track.preview) {\n      console.warn('Track has no preview URL');\n      return;\n    }\n\n    setCurrentTrack(track);\n    setIsPlaying(true);\n    \n    if (audioRef.current) {\n      audioRef.current.src = track.preview;\n      audioRef.current.load();\n    }\n  };\n\n  const togglePlayPause = () => {\n    if (!audioRef.current || !currentTrack) return;\n\n    if (isPlaying) {\n      audioRef.current.pause();\n      setIsPlaying(false);\n    } else {\n      audioRef.current.play().catch(console.error);\n      setIsPlaying(true);\n    }\n  };\n\n  const seekTo = (time) => {\n    if (audioRef.current) {\n      audioRef.current.currentTime = time;\n      setCurrentTime(time);\n    }\n  };\n\n  const playNext = () => {\n    if (queue.length > 0 && currentIndex < queue.length - 1) {\n      const nextIndex = currentIndex + 1;\n      setCurrentIndex(nextIndex);\n      playTrack(queue[nextIndex]);\n    } else {\n      setIsPlaying(false);\n    }\n  };\n\n  const playPrevious = () => {\n    if (queue.length > 0 && currentIndex > 0) {\n      const prevIndex = currentIndex - 1;\n      setCurrentIndex(prevIndex);\n      playTrack(queue[prevIndex]);\n    }\n  };\n\n  const addToQueue = (tracks) => {\n    setQueue(prevQueue => [...prevQueue, ...tracks]);\n  };\n\n  const clearQueue = () => {\n    setQueue([]);\n    setCurrentIndex(0);\n  };\n\n  const playQueue = (tracks, startIndex = 0) => {\n    setQueue(tracks);\n    setCurrentIndex(startIndex);\n    if (tracks[startIndex]) {\n      playTrack(tracks[startIndex]);\n    }\n  };\n\n  const formatTime = (time) => {\n    if (isNaN(time)) return '0:00';\n    \n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    return `${minutes}:${seconds.toString().padStart(2, '0')}`;\n  };\n\n  const value = {\n    currentTrack,\n    isPlaying,\n    currentTime,\n    duration,\n    volume,\n    queue,\n    currentIndex,\n    playTrack,\n    togglePlayPause,\n    seekTo,\n    playNext,\n    playPrevious,\n    setVolume,\n    addToQueue,\n    clearQueue,\n    playQueue,\n    formatTime\n  };\n\n  return (\n    <PlayerContext.Provider value={value}>\n      {children}\n      <audio ref={audioRef} />\n    </PlayerContext.Provider>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}